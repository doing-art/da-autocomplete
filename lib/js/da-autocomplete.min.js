/*!
 * 
 *            da-autocomplete - There is a test project.
 *            Author: Paramonov_Nick <paramonov.work@gmail.com>
 *            Version: v1.0.0
 *            Url: undefined
 *            License(s): MIT
 *         
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.da=t():e.da=t()}(this,function(){return function(e){function t(e){delete installedChunks[e]}function o(e){var t=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.charset="utf-8",o.src=f.p+""+e+"."+g+".hot-update.js",t.appendChild(o)}function n(){return new Promise(function(e,t){if("undefined"==typeof XMLHttpRequest)return t(Error("No browser support"));try{var o=new XMLHttpRequest,n=f.p+""+g+".hot-update.json";o.open("GET",n,!0),o.timeout=1e4,o.send(null)}catch(e){return t(e)}o.onreadystatechange=function(){if(4===o.readyState)if(0===o.status)t(Error("Manifest request to "+n+" timed out."));else if(404===o.status)e();else if(200!==o.status&&304!==o.status)t(Error("Manifest request to "+n+" failed."));else{try{var r=JSON.parse(o.responseText)}catch(e){return void t(e)}e(r)}}})}function r(e){var t=M[e];if(!t)return f;var o=function(o){return t.hot.active?(M[o]?M[o].parents.indexOf(e)<0&&M[o].parents.push(e):w=[e],t.children.indexOf(o)<0&&t.children.push(o)):w=[],E=!1,f(o)},n=function(e){return{configurable:!0,enumerable:!0,get:function(){return f[e]},set:function(t){f[e]=t}}};for(var r in f)Object.prototype.hasOwnProperty.call(f,r)&&Object.defineProperty(o,r,n(r));return Object.defineProperty(o,"e",{enumerable:!0,value:function(e){function t(){S--,"prepare"===k&&(C[e]||u(e),0===S&&0===O&&d())}return"ready"===k&&i("prepare"),S++,f.e(e).then(t,function(e){throw t(),e})}}),o}function a(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:E,active:!0,accept:function(e,o){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._acceptedDependencies[e[n]]=o||function(){};else t._acceptedDependencies[e]=o||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var o=0;o<e.length;o++)t._declinedDependencies[e[o]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var o=t._disposeHandlers.indexOf(e);o>=0&&t._disposeHandlers.splice(o,1)},check:c,apply:p,status:function(e){if(!e)return k;x.push(e)},addStatusHandler:function(e){x.push(e)},removeStatusHandler:function(e){var t=x.indexOf(e);t>=0&&x.splice(t,1)},data:b[e]};return E=!0,t}function i(e){k=e;for(var t=0;t<x.length;t++)x[t].call(null,e)}function s(e){return+e+""===e?+e:e}function c(e){if("idle"!==k)throw Error("check() is only allowed in idle status");return y=e,i("check"),n().then(function(e){if(!e)return i("idle"),null;D={},C={},T=e.c,v=e.h,i("prepare");var t=new Promise(function(e,t){_={resolve:e,reject:t}});return m={},u(0),"prepare"===k&&0===S&&0===O&&d(),t})}function l(e,t){if(T[e]&&D[e]){D[e]=!1;for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(m[o]=t[o]);0==--O&&0===S&&d()}}function u(e){T[e]?(D[e]=!0,O++,o(e)):C[e]=!0}function d(){i("ready");var e=_;if(_=null,e)if(y)p(y).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var o in m)Object.prototype.hasOwnProperty.call(m,o)&&t.push(s(o));e.resolve(t)}}function p(o){function n(e){for(var t=[e],o={},n=t.slice().map(function(e){return{chain:[e],id:e}});n.length>0;){var a=n.pop(),i=a.id,s=a.chain;if((u=M[i])&&!u.hot._selfAccepted){if(u.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:i};if(u.hot._main)return{type:"unaccepted",chain:s,moduleId:i};for(var c=0;c<u.parents.length;c++){var l=u.parents[c],d=M[l];if(d){if(d.hot._declinedDependencies[i])return{type:"declined",chain:s.concat([l]),moduleId:i,parentId:l};t.indexOf(l)>=0||(d.hot._acceptedDependencies[i]?(o[l]||(o[l]=[]),r(o[l],[i])):(delete o[l],t.push(l),n.push({chain:s.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:o}}function r(e,t){for(var o=0;o<t.length;o++){var n=t[o];e.indexOf(n)<0&&e.push(n)}}if("ready"!==k)throw Error("apply() is only allowed in ready status");o=o||{};var a,c,l,u,d,p={},h=[],_={},y=function(){};for(var E in m)if(Object.prototype.hasOwnProperty.call(m,E)){d=s(E);var L;L=m[E]?n(d):{type:"disposed",moduleId:E};var x=!1,O=!1,S=!1,C="";switch(L.chain&&(C="\nUpdate propagation: "+L.chain.join(" -> ")),L.type){case"self-declined":o.onDeclined&&o.onDeclined(L),o.ignoreDeclined||(x=Error("Aborted because of self decline: "+L.moduleId+C));break;case"declined":o.onDeclined&&o.onDeclined(L),o.ignoreDeclined||(x=Error("Aborted because of declined dependency: "+L.moduleId+" in "+L.parentId+C));break;case"unaccepted":o.onUnaccepted&&o.onUnaccepted(L),o.ignoreUnaccepted||(x=Error("Aborted because "+d+" is not accepted"+C));break;case"accepted":o.onAccepted&&o.onAccepted(L),O=!0;break;case"disposed":o.onDisposed&&o.onDisposed(L),S=!0;break;default:throw Error("Unexception type "+L.type)}if(x)return i("abort"),Promise.reject(x);if(O){_[d]=m[d],r(h,L.outdatedModules);for(d in L.outdatedDependencies)Object.prototype.hasOwnProperty.call(L.outdatedDependencies,d)&&(p[d]||(p[d]=[]),r(p[d],L.outdatedDependencies[d]))}S&&(r(h,[L.moduleId]),_[d]=y)}var D=[];for(c=0;c<h.length;c++)d=h[c],M[d]&&M[d].hot._selfAccepted&&D.push({module:d,errorHandler:M[d].hot._selfAccepted});i("dispose"),Object.keys(T).forEach(function(e){T[e]===!1&&t(e)});for(var j,P=h.slice();P.length>0;)if(d=P.pop(),u=M[d]){var N={},I=u.hot._disposeHandlers;for(l=0;l<I.length;l++)(a=I[l])(N);for(b[d]=N,u.hot.active=!1,delete M[d],l=0;l<u.children.length;l++){var H=M[u.children[l]];H&&((j=H.parents.indexOf(d))>=0&&H.parents.splice(j,1))}}var F,R;for(d in p)if(Object.prototype.hasOwnProperty.call(p,d)&&(u=M[d]))for(R=p[d],l=0;l<R.length;l++)F=R[l],(j=u.children.indexOf(F))>=0&&u.children.splice(j,1);i("apply"),g=v;for(d in _)Object.prototype.hasOwnProperty.call(_,d)&&(e[d]=_[d]);var q=null;for(d in p)if(Object.prototype.hasOwnProperty.call(p,d)){u=M[d],R=p[d];var A=[];for(c=0;c<R.length;c++)F=R[c],a=u.hot._acceptedDependencies[F],A.indexOf(a)>=0||A.push(a);for(c=0;c<A.length;c++){a=A[c];try{a(R)}catch(e){o.onErrored&&o.onErrored({type:"accept-errored",moduleId:d,dependencyId:R[c],error:e}),o.ignoreErrored||q||(q=e)}}}for(c=0;c<D.length;c++){var U=D[c];d=U.module,w=[d];try{f(d)}catch(e){if("function"==typeof U.errorHandler)try{U.errorHandler(e)}catch(t){o.onErrored&&o.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:t,orginalError:e}),o.ignoreErrored||q||(q=t),q||(q=e)}else o.onErrored&&o.onErrored({type:"self-accept-errored",moduleId:d,error:e}),o.ignoreErrored||q||(q=e)}}return q?(i("fail"),Promise.reject(q)):(i("idle"),Promise.resolve(h))}function f(t){if(M[t])return M[t].exports;var o=M[t]={i:t,l:!1,exports:{},hot:a(t),parents:(L=w,w=[],L),children:[]};return e[t].call(o.exports,o,o.exports,r(t)),o.l=!0,o.exports}var h=this.webpackHotUpdateda;this.webpackHotUpdateda=function(e,t){l(e,t),h&&h(e,t)};var _,m,v,y=!0,g="61a42b94435fd4ca4905",b={},E=!0,w=[],L=[],x=[],k="idle",O=0,S=0,C={},D={},T={},M={};return f.m=e,f.c=M,f.i=function(e){return e},f.d=function(e,t,o){f.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},f.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return f.d(t,"a",t),t},f.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},f.p="../",f.h=function(){return g},r(3)(f.s=3)}([function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var o=[],n=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(o.push(i.value),!t||o.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=o(1),c=n(s),l=o(2),u=n(l),d=function(){function e(t,o){r(this,e),e._counter=e._counter||0,this._controlId="da-autocomplete-search-control-"+ ++e._counter,t&&(this._initControlExisting(t),this._initConfig(o),this._initTemplate(),this._initSearch(),this._initParentForm(),this._initResult(),this._initValidation())}return i(e,[{key:"_initControlExisting",value:function(e){e&&(this._controlExisting="string"==typeof e?document.querySelector(e):e)}},{key:"_initConfig",value:function(e){if(this._config={},e)for(var t in c.default)this._config[t]=e[t]||c.default[t];else for(var o in c.default)this._config[o]=c.default[o]}},{key:"_initTemplate",value:function(){var e=document.createElement("div"),t=this._controlExisting.parentNode,o=this._controlExisting.offsetWidth;e.className="da-autocomplete",e.style.width=o+"px",t.replaceChild(e,this._controlExisting),this._autocomplete=e}},{key:"_initSearch",value:function(){var e=this,t=document.createElement("div"),o=document.createElement("label"),n=this._controlExisting.cloneNode(!0),r=u.default.newEvent("click");n.id=this._controlId,n.classList.add("da-autocomplete__search-control"),n.addEventListener("focus",function(){e._autocomplete.classList.add("da-autocomplete--focus"),!e._autocomplete.classList.contains("da-autocomplete--select")&&n.value.length>0&&e._open()}),n.addEventListener("blur",function(){e._autocomplete.classList.remove("da-autocomplete--focus")}),n.addEventListener("input",function(){n.value.length>0?(e._open(),e._autocomplete.classList.add("da-autocomplete--full")):(e._close(),e._autocomplete.classList.remove("da-autocomplete--full")),e._startSearch(n.value)}),n.addEventListener("keyup",function(t){var o=void 0;if(e._isOpen()){switch(t.keyCode){case 38:o=e._itemFocused.previousElementSibling,o&&e._setFocusedItem(o);break;case 40:o=e._itemFocused.nextElementSibling,o&&e._setFocusedItem(o);break;case 27:e._close();break;case 13:e._resultList.childElementCount?e._itemFocused.dispatchEvent(r):e._onClose(r),e._moveFocusToNext()}t.preventDefault(),t.stopPropagation()}}),document.addEventListener("click",function(t){!u.default.isChildOf(t.target,e._autocomplete)&&e._isOpen()&&e._onClose(r)}),o.innerText=this._config.placeholderMessage,o.htmlFor=this._controlId,o.className="da-autocomplete__search-placeholder",o.setAttribute("unselectable","on"),t.className="da-autocomplete__search",t.appendChild(n),t.appendChild(o),this._search=t,this._control=n,this._autocomplete.appendChild(t)}},{key:"_initParentForm",value:function(){var e=this;this._parentForm=this._control.form,this._parentForm&&this._parentForm.addEventListener("keypress",function(t){if(13==t.keyCode&&e._isOpen())return t.preventDefault(),!1})}},{key:"_initResult",value:function(){var e=this,t=document.createElement("div"),o=document.createElement("ul"),n=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div");t.className="da-autocomplete__result",o.className="da-autocomplete__result-list",n.className="da-autocomplete__result-preloader",n.innerText=this._config.preloaderText,r.className="da-autocomplete__result-success",a.className="da-autocomplete__result-empty",a.innerText=this._config.serverEmptyMessage,i.className="da-autocomplete__result-notification",s.className="da-autocomplete__result-message",s.innerText=this._config.serverErrorMessage,c.className="da-autocomplete__result-reload",c.innerText=this._config.reloadButtonText,c.addEventListener("click",function(){e._startSearch(e._control.value)}),i.appendChild(s),i.appendChild(c),t.appendChild(o),t.appendChild(n),t.appendChild(r),t.appendChild(a),t.appendChild(i),this._preloader=n,this._resultList=o,this._success=r,this._autocomplete.appendChild(t)}},{key:"_initValidation",value:function(){var e=document.createElement("label"),t=document.createElement("div");e.className="da-autocomplete__validation",e.htmlFor=this._controlId,t.className="da-autocomplete__validation-error",t.innerText=this._config.validationErrorMessage,e.appendChild(t),this._autocomplete.appendChild(e)}},{key:"_startSearch",value:function(e){var t=this,o="onload"in new XMLHttpRequest?XMLHttpRequest:XDomainRequest,n=this._config.requestUrl+"?searchPhrase="+e+"&resultNumberToShow="+this._config.resultNumberToShow,r=new o;this._xhr&&(this._xhr.abort(),this._onSearchRequestComplete()),r.open("GET",n,!0),r.setRequestHeader("Content-Type","application/json"),new Promise(function(e,o){r.onload=function(){t._onSearchRequestComplete(function(){200===r.status?e(r.responseText&&JSON.parse(r.responseText)):o()})},t._timer=t._showPreloader(),t._clearResult(),r.send()}).then(function(e){e.data&&e.data.length?(t._resultList.innerHTML=t._getResultListContent(e.data),t._reinitResultItems(),t._showSuccesMessage(e.data.length,e.total)):t._autocomplete.classList.add("da-autocomplete--empty")},function(){t._autocomplete.classList.add("da-autocomplete--error"),t._hideSuccesMessage()}),this._xhr=r}},{key:"_onSearchRequestComplete",value:function(e){var t=void 0;this._timer&&clearTimeout(this._timer),t=this._hidePrloader(),e&&t.then(e)}},{key:"_reinitResultItems",value:function(){var e=this,t=this._resultList.querySelectorAll(".da-autocomplete__result-item"),o=this._itemSelected=this._resultList.querySelector(".da-autocomplete__result-item--select");this._itemFocused=t&&t[0];var n=!0,r=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;c.addEventListener("click",function(t){e._control.value=t.target.innerText,e._clearResult(),e._autocomplete.classList.add("da-autocomplete--select"),o=t.target,o.classList.add("da-autocomplete__result-item--select"),e._itemSelected=o,e._close()}),c.addEventListener("mouseenter",function(t){e._setFocusedItem(t.target)})}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}}},{key:"_onClose",value:function(e){var t=this._resultList.childElementCount;(1!==t||this._isLoading())&&this._showError(),1===t&&this._resultList.querySelector(".da-autocomplete__result-item").dispatchEvent(e),this._clearSelected(),this._close()}},{key:"_moveFocusToNext",value:function(){var e=this._parentForm.querySelectorAll("input,button,textarea,select"),t=!1,o=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var s=a.value;if(s!=this._control){if(t){s.focus();break}}else t=!0}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"_setFocusedItem",value:function(e){this._itemFocused&&this._itemFocused.classList.remove("da-autocomplete__result-item--focus"),e.classList.add("da-autocomplete__result-item--focus"),this._itemFocused=e}},{key:"_clearResult",value:function(){this._resultList.innerHTML="",this._autocomplete.classList.remove("da-autocomplete--error"),this._autocomplete.classList.remove("da-autocomplete--success"),this._autocomplete.classList.remove("da-autocomplete--empty"),this._autocomplete.classList.remove("da-autocomplete--validation-error"),this._autocomplete.classList.remove("da-autocomplete--select")}},{key:"_clearSelected",value:function(){this._itemSelected&&(this._itemSelected.classList.remove("da-autocomplete__result-item--select"),this._itemSelected=null)}},{key:"_showSuccesMessage",value:function(e,t){var o=this._config.serverSucccessMessage;o=o.replace(/\$\{shown\}/,e),o=o.replace(/\$\{total\}/,t),this._success.innerText=o,e&&t&&t>e&&this._autocomplete.classList.add("da-autocomplete--success")}},{key:"_hideSuccesMessage",value:function(){this._autocomplete.classList.remove("da-autocomplete--success")}},{key:"_showPreloader",value:function(){var e=this;return setTimeout(function(){e._preloader.classList.add("da-autocomplete__result-preloader--show"),e._preloaderShowMoment=new Date},this._config.preloaderShowingDelay)}},{key:"_hidePrloader",value:function(){var e=this,t=this._preloaderShowMoment,o=this._config.preloaderMinShowDuration,n=t?new Date-t:o,r=n<o?o-n:0;return t=null,new Promise(function(t){setTimeout(function(){e._preloader.classList.remove("da-autocomplete__result-preloader--show"),t()},r)})}},{key:"_showError",value:function(){this._autocomplete.classList.add("da-autocomplete--validation-error")}},{key:"_open",value:function(){window.innerHeight-this._control.getBoundingClientRect().bottom<this._config.openOnTopDistance&&this._autocomplete.classList.add("da-autocomplete--open-top"),this._autocomplete.classList.add("da-autocomplete--open")}},{key:"_close",value:function(){this._autocomplete.classList.remove("da-autocomplete--open"),this._autocomplete.classList.remove("da-autocomplete--open-top")}},{key:"_isOpen",value:function(){return this._autocomplete.classList.contains("da-autocomplete--open")}},{key:"_isLoading",value:function(){return this._preloader.classList.contains("da-autocomplete__result-preloader--show")}},{key:"_getResultListContent",value:function(e){var t="",o=this._itemSelected&&this._itemSelected.innerText;if(e){var n=!0,r=!1,i=void 0;try{for(var s,c=e.entries()[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var l=a(s.value,2),u=l[0],d=l[1];t+='<li class="da-autocomplete__result-item '+(0===u?"da-autocomplete__result-item--focus":"")+" "+(d.City===o?"da-autocomplete__result-item--select":"")+'">'+d.City+"</li>"}}catch(e){r=!0,i=e}finally{try{!n&&c.return&&c.return()}finally{if(r)throw i}}}return t}}]),e}();t.default=d},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={placeholderMessage:"Начните вводить код или название",serverErrorMessage:"Что-то пошло не так. Проверьте соединение с интернетом и попробуйте еще раз",serverSucccessMessage:"Показано ${shown} из ${total} найденных городов. Уточните запрос, чтобы увидеть остальные",serverEmptyMessage:"Не найдено",reloadButtonText:"Обновить",preloaderText:"Загрузка",validationErrorMessage:"Выберите значение из списка",requestUrl:"/search",openOnTopDistance:200,preloaderShowingDelay:500,preloaderMinShowDuration:1e3,resultNumberToShow:5}},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return r(e,null,[{key:"isChildOf",value:function(t,o){return t.parentNode===o||null!==t.parentNode&&e.isChildOf(t.parentNode,o)}},{key:"newEvent",value:function(e){var t=void 0;return"function"==typeof Event?t=new Event(e):(t=document.createEvent("Event"),t.initEvent(e,!0,!0)),t}}]),e}();t.default=a},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DaAutocomplete=void 0;var r=o(0),a=n(r);t.DaAutocomplete=a.default}])});